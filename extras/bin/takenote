#!/bin/zsh

set -e

ARG1=$1
echo $ARG1
[[ $ARG1 == "-p" ]] && shift;

ARG=$@
ARG=${ARG// /-}

echo $ARG

NOTESDIR=~/notes
[ ! -z $ARG ] && NOTE="$ARG.md"
if [[ ! -z $ARG1 ]]; then
   echo "Private note";
   NOTESDIR=~/notes/private
fi

[ ! -d "$NOTESDIR" ] && mkdir $NOTESDIR
cd $NOTESDIR
if [[ -f $NOTE ]]; then
   vim -c 'set statusline="hello dear"' $NOTE +4 
   exit
fi
touch $NOTE
DATE=$(date '+%Y-%m-%d %H:%M:%S')
cat << EOD >> $NOTE
# $@
$DATE
----------------------------------------- <hr>

```bash
```
-----------------------------------------
EOD

vim $NOTE +4

echo "your note was saved in [$NOTESDIR/$NOTE]"

exit 0
